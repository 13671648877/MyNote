# sar

---

`System Activity Reporter`系统活动情况报告. 是`Linux`性能分析工具之一, 可以从多方面对系统的活动进行报告.

包括: 文件的读写情况,系统调用的使用情况,磁盘I/O,CPU效率,内存使用状况,进程活动及IPC有关的活动等. 使用它时消耗的系统资源很小

## 语法

`sar[options][-A][-o file]t[n]`

* `t`为采样间隔.
* `n`为采样次数, 默认值是`1`.
* `-o file`表示将命令结果以二进制格式存放在文件中, `file`是文件名. `sar -u -f 文件名`表示读取二进制文件.

### options 选项

* `-A`: 显示所有的报告信息.
* `-u`: 输出`CPU`使用情况的统计信息.
* `-v`：输出`inode`、文件和其他内核表的统计信息.
* `-b`: 显示`I/O`速率.
* `-d`: 输出每一个块设备的活动信息.
* `-r`: 输出内存和交换空间的统计信息.
* `-B`: 显示换页状态.
* `-a`: 文件读写情况.
* `-c`: 输出进程统计信息, 每秒创建的进程.
* `-q`: 输出进程队列长度和平均负载状态统计信息.
* `-R`: 输出内存页面的统计信息.
* `-y`: 终端设备活动情况.
* `-w`: 输出系统交换活动信息.
* `-n { DEV | EDEV | NFS | NFSD | SOCK | ALL }`: 分析输出网络设备状态统计信息.
	* `DEV`: 报告网络设备的统计信息.
	* `EDEV`: 报告网络设备的错误统计信息.
	* `NFS`: 报告`NFS`**客户端**的活动统计信息.
	* `NFSD`: 报告`NFS`**服务器**的活动统计信息.
	* `SOCK`: 报告网络套接字(sockets)的使用统计信息.
* `-j`: 显示持久化设备名称.
* `-s hh:mm:ss`: 指定输出统计数据的起始时间.
* `-e hh:mm:ss`: 指定输出统计数据的截至时间，默认为`18:00:00`.

### cpu 监控`sar -u`

```
# 每5秒采样一次, 连续采样3次, 并将采样结果以二进制形式存入当前目录下的文件test中
sar -u -o test 5 3

03:47:03 PM     CPU     %user     %nice   %system   %iowait    %steal     %idle
03:47:08 PM     all      0.00      0.00      0.20      0.00      0.00     99.80
03:47:13 PM     all      0.00      0.00      0.10      0.00      0.00     99.90
03:47:18 PM     all      0.10      0.00      0.20      0.00      0.00     99.70
Average:        all      0.03      0.00      0.17      0.00      0.00     99.80
```

* `CPU`: `all`表示统计信息为所有`CPU`的平均值.
* `%user`: 显示在用户级别(application)运行使用`CPU`总时间的百分比.
* `%nice`: 改变过优先级的进程的占用CPU的百分比.
* `%system`: 在核心级别(kernel)运行所使用`CPU`总时间的百分比.
* `%iowait`: 显示用于**等待I/O操作**占用`CPU`总时间的百分比.
* `%steal`: 管理程序(hypervisor)为另一个虚拟进程提供服务而等待虚拟`CPU`的百分比(低`steal`值意味着应用程序在目前的虚拟机上运作良好.因为虚拟机不会经常地为了`CPU`时间与其它虚拟机激烈竞争,虚拟机会更快地响应).
* `%idle`: 显示`CPU`空闲时间占用`CPU`总时间的百分比.

#### 常见问题

* 若`%iowait`的值过高,表示硬盘存在I/O瓶颈.
* 若`%idle`的值高但系统响应慢时,有可能是`CPU`等待分配内存, 此时应加大内存容量.
* 若`%idle`的值持续低于10, 则系统的`CPU`处理能力相对较低, 表明系统中最需要解决的资源是`CPU`.

### 显示I/O和传送速率的统计信息`sar -b`

```
sar -b
Linux 3.10.0-514.el7.x86_64 (mysql-1) 	03/08/2018 	_x86_64_	(2 CPU)

01:50:01 PM       tps      rtps      wtps   bread/s   bwrtn/s
02:00:01 PM      0.14      0.02      0.12      0.75      1.06
02:10:01 PM      0.13      0.00      0.13      0.00      0.99
02:20:01 PM      0.40      0.00      0.40      0.00      4.64
02:30:01 PM      0.13      0.00      0.13      0.00      0.82
02:40:01 PM      0.12      0.00      0.12      0.00      0.85
02:50:01 PM      0.09      0.00      0.09      0.00      1.09
03:00:01 PM      0.10      0.00      0.10      0.00      1.19
03:10:01 PM      0.14      0.00      0.14      0.00      2.60
03:20:02 PM      0.08      0.00      0.08      0.00      0.96
03:30:01 PM      0.12      0.00      0.12      0.00      0.83
03:40:01 PM      0.11      0.00      0.11      0.00      0.76
03:50:01 PM      0.11      0.00      0.11      0.00      0.83
04:00:01 PM      0.12      0.00      0.12      0.00      0.95
04:10:01 PM      0.15      0.00      0.15      0.00      2.60
04:20:01 PM      0.10      0.00      0.10      0.00      0.58
Average:         0.14      0.00      0.14      0.05      1.39
```

* `tps`: 每秒钟物理设备的`I/O`传输总量.
* `rtps`: 每秒钟从物理设备**读入**的数据总量.
* `wtps`: 每秒钟向物理设备**写入**的数据总量.
* `bread/s`: 每秒钟从物理设备读入的数据量,单位为(块/s).
* `bwrtn/s`: 每秒钟向物理设备写入的数据量,单位为(块/s).

### inode, 文件和其他内核表监控`sar -v`

```
sar -v
Linux 3.10.0-514.el7.x86_64 (mysql-1) 	03/08/2018 	_x86_64_	(2 CPU)

01:50:01 PM dentunusd   file-nr  inode-nr    pty-nr
02:00:01 PM     41746      1344     26641         2
02:10:01 PM     41758      1344     26641         2
02:20:01 PM     41764      1344     26641         2
02:30:01 PM     41770      1312     26641         2
02:40:01 PM     41776      1344     26641         2
02:50:01 PM     41782      1344     26641         2
03:00:01 PM     41788      1344     26641         2
03:10:01 PM     41800      1344     26641         2
03:20:02 PM     41806      1344     26641         2
03:30:01 PM     41812      1344     26641         2
03:40:01 PM     41821      1344     26641         2
03:50:01 PM     41828      1344     26642         2
Average:        41788      1341     26641         2
```

* `dentunusd`: 目录高速缓存中未被使用的条目数量.
* `file-nr`: 文件句柄(file handle)的使用数量.
* `inode-nr`: 索引节点句柄(inode handle)的使用数量.
* `pty-nr`: 使用的pty数量.

#### dentunusd

`dcache`(目录高速缓存),因为系统中所有的`inode`都是通过文件名来访问的,而为了解决文件名到`inode`转换的时间,就引入了`dcache`.它是VFS层为当前活动和最近使用的名字维护的一个cache.
`dcache`中所有处于`unused`状态和`negative`(消极)状态的`dentry`对象都通链入到`dentry_unused`链表中,这种`dentry`对象在回收内存时可能会被释放.

### 输出内存页面的统计信息`sar -B`

```
sar -B
Linux 3.10.0-514.el7.x86_64 (mysql-1) 	03/08/2018 	_x86_64_	(2 CPU)

01:50:01 PM  pgpgin/s pgpgout/s   fault/s  majflt/s  pgfree/s pgscank/s pgscand/s pgsteal/s    %vmeff
02:00:01 PM      0.37      0.53      9.19      0.00     16.28      0.00      0.00      0.00      0.00
02:10:01 PM      0.00      0.50     13.84      0.00     17.37      0.00      0.00      0.00      0.00
02:20:01 PM      0.00      2.32      5.22      0.00     15.09      0.00      0.00      0.00      0.00
02:30:01 PM      0.00      0.41      5.24      0.00     13.14      0.00      0.00      0.00      0.00
02:40:01 PM      0.00      0.43      5.22      0.00     13.84      0.00      0.00      0.00      0.00
02:50:01 PM      0.00      0.54      5.23      0.00     13.63      0.00      0.00      0.00      0.00
03:00:01 PM      0.00      0.60      5.23      0.00     14.00      0.00      0.00      0.00      0.00
03:10:01 PM      0.00      1.30     13.83      0.00     19.63      0.00      0.00      0.00      0.00
03:20:02 PM      0.00      0.48      5.23      0.00     15.37      0.00      0.00      0.00      0.00
03:30:01 PM      0.00      0.41      5.24      0.00     15.86      0.00      0.00      0.00      0.00
03:40:01 PM      0.00      0.38      6.82      0.00     13.85      0.00      0.00      0.00      0.00
03:50:01 PM      0.00      0.41      6.58      0.00     14.35      0.00      0.00      0.00      0.00
04:00:01 PM      0.00      0.48      7.79      0.00     15.28      0.00      0.00      0.00      0.00
04:10:01 PM      0.00      1.30     14.60      0.00     17.25      0.00      0.00      0.00      0.00
04:20:01 PM      0.00      0.29      5.23      0.00     14.32      0.00      0.00      0.00      0.00
04:30:01 PM      0.00      0.37      5.81      0.00     13.28      0.00      0.00      0.00      0.00
04:40:01 PM      0.00      0.44      5.25      0.00     14.75      0.00      0.00      0.00      0.00
04:50:01 PM      0.00      0.40      5.22      0.00     13.56      0.00      0.00      0.00      0.00
05:00:01 PM      0.00      0.24      5.23      0.00     14.50      0.00      0.00      0.00      0.00
```

* `pgpgin/s`: 每秒从磁盘或SWAP置换到内存的字节数(KB).
* `pgpgout/s`: 每秒从内存置换到磁盘或SWAP的字节数(KB).
* `fault/s`: 每秒钟系统产生的缺页数,即主缺页与次缺页之和(major + minor).
* `majflt/s`: 每秒钟产生的主缺页数.
* `pgfree/s`: 每秒被放入空闲队列中的页个数.
* `pgscank/s`: 每秒被`kswapd`(kswapd是linux中用于页面回收的内核线程)扫描的页个数.
* `pgscand/s`: 每秒直接被扫描的页个数.
* `pgsteal/s`: 每秒钟从cache中被清除来满足内存需要的页个数
* `%vmeff`: 每秒清除的页(pgsteal)占总扫描页(pgscank+pgscand)的百分比

### 内存和交换空间的统计信息`sar -r`

```
sar -r
Linux 3.10.0-514.el7.x86_64 (mysql-1) 	03/08/2018 	_x86_64_	(2 CPU)

01:50:01 PM kbmemfree kbmemused  %memused kbbuffers  kbcached  kbcommit   %commit  kbactive   kbinact   kbdirty
02:00:01 PM    823484   1060188     56.28      1856    486656   2327612     58.47    640924    294196         8
02:10:01 PM    823596   1060076     56.28      1856    486660   2327612     58.47    640856    294196         4
02:20:01 PM    823408   1060264     56.29      1856    486680   2327612     58.47    640960    294196         4
02:30:01 PM    823568   1060104     56.28      1856    486688   2327612     58.47    640960    294196         4
02:40:01 PM    823772   1059900     56.27      1856    486696   2327612     58.47    640884    294200         4
02:50:01 PM    823828   1059844     56.26      1856    486700   2327612     58.47    640900    294196         0
03:00:01 PM    823864   1059808     56.26      1856    486704   2327612     58.47    640900    294196         0
03:10:01 PM    823788   1059884     56.27      1856    486712   2327612     58.47    640908    294196         0
03:20:02 PM    823584   1060088     56.28      1856    486716   2327612     58.47    640920    294196         0
03:30:01 PM    823500   1060172     56.28      1856    486720   2327612     58.47    640908    294200         4
03:40:01 PM    823344   1060328     56.29      1856    486724   2327612     58.47    640960    294144         4
03:50:01 PM    823324   1060348     56.29      1856    486780   2327612     58.47    641132    294136         4
04:00:01 PM    823352   1060320     56.29      1856    486788   2327612     58.47    641184    294132         4
Average:       823570   1060102     56.28      1856    486710   2327612     58.47    640954    294183         3
```

* `kbmemfree`：这个值和free命令中的free值基本一致,所以它不包括buffer和cache的空间.
* `kbmemused`：这个值和free命令中的used值基本一致,所以它包括buffer和cache的空间.
* `%memused`：这个值是kbmemused和内存总量(不包括swap)的一个百分比.
* `kbbuffers`和`kbcached`: 这两个值就是`free`命令中的`buffer`和`cache`.
* `kbcommit`: 保证当前系统所需要的内存,即为了确保不溢出而需要的内存(`RAM+swap`).
* `%commit`：这个值是`kbcommit`与内存总量(包括swap)的一个百分比.
* `kbactive`: 活跃内存的大小(内存最近被使用过，并且不会被回收).
* `kbinact`: 不活跃内存大小(最近未被使用的内存, 很符合回收策略的内存).
* `kbdirty`: 等待写回硬盘的内存数量.

### 输出内存页面的统计信息 `sar -R`

```
sar -R
Linux 3.10.0-514.el7.x86_64 (mysql-1) 	03/08/2018 	_x86_64_	(2 CPU)

01:50:01 PM   frmpg/s   bufpg/s   campg/s
02:00:01 PM     -0.01      0.02      0.08
02:10:01 PM      0.05      0.00      0.00
02:20:01 PM     -0.08      0.00      0.01
02:30:01 PM      0.07      0.00      0.00
02:40:01 PM      0.08      0.00      0.00
02:50:01 PM      0.02      0.00      0.00
03:00:01 PM      0.01      0.00      0.00
03:10:01 PM     -0.03      0.00      0.00
03:20:02 PM     -0.08      0.00      0.00
03:30:01 PM     -0.04      0.00      0.00
03:40:01 PM     -0.06      0.00      0.00
03:50:01 PM     -0.01      0.00      0.02
04:00:01 PM      0.01      0.00      0.00
04:10:01 PM      0.03      0.00      0.00
04:20:01 PM      0.02      0.00      0.00
04:30:01 PM      0.02      0.00      0.00
04:40:01 PM     -0.17      0.00      0.00
04:50:01 PM      0.13      0.00      0.00
05:00:01 PM     -0.06      0.00      0.00
05:10:01 PM     -0.02      0.00      0.00
05:20:01 PM     -0.02      0.00      0.04
Average:        -0.01      0.00      0.01
```

* `frmpg/s`: 每秒系统中每秒内存释放的内存页面(memory page freed)数量.负数说明系统分配的页数.
* `bufpg/s`: 每秒系统中用作缓冲区(buffer)的附加内存页面(additional memory page)数量.
* `campg/s`: 每秒系统中高速缓存的附加内存页面(additional memory pages cached)数量.

### 输出网络设备状态的统计信息 `sar -n DEV | grep xxxx`

```
sar -n DEV
Linux 3.10.0-514.el7.x86_64 (mysql-1) 	03/08/2018 	_x86_64_	(2 CPU)

01:50:01 PM     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s
02:00:01 PM    enp0s3     14.96     14.39      2.40      2.53      0.00      0.00      0.01
02:00:01 PM        lo      3.93      3.93      0.75      0.75      0.00      0.00      0.00
02:00:01 PM   docker0      0.00      0.00      0.00      0.00      0.00      0.00      0.00
...


sar -n DEV | egrep 'enp0s3|IFACE'
01:50:01 PM     IFACE   rxpck/s   txpck/s    rxkB/s    txkB/s   rxcmp/s   txcmp/s  rxmcst/s
02:00:01 PM    enp0s3     14.96     14.39      2.40      2.53      0.00      0.00      0.01
02:10:01 PM    enp0s3     16.05     12.77      2.47      2.22      0.00      0.00      0.01
02:20:01 PM    enp0s3     14.53     13.74      2.47      2.38      0.00      0.00      0.01
02:30:01 PM    enp0s3     13.59     12.96      2.14      2.33      0.00      0.00      0.01
02:40:01 PM    enp0s3     14.43     13.84      2.29      2.45      0.00      0.00      0.01
02:50:01 PM    enp0s3     12.24     11.91      2.13      2.10      0.00      0.00      0.01
03:00:01 PM    enp0s3     14.11     13.57      2.28      2.48      0.00      0.00      0.01
03:10:01 PM    enp0s3     20.80     18.93      2.87      4.11      0.00      0.00      0.01
03:20:02 PM    enp0s3     14.72     13.94      2.47      2.54      0.00      0.00      0.01
03:30:01 PM    enp0s3     18.81     17.04      2.73      3.53      0.00      0.00      0.01
03:40:01 PM    enp0s3     13.41     13.20      2.20      2.35      0.00      0.00      0.01
03:50:01 PM    enp0s3     12.18     11.92      2.11      2.14      0.00      0.00      0.01
04:00:01 PM    enp0s3     13.96     13.56      2.34      2.36      0.00      0.00      0.01
04:10:01 PM    enp0s3     12.40     12.16      2.18      2.07      0.00      0.00      0.01
04:20:01 PM    enp0s3     14.25     12.83      2.31      2.20      0.00      0.00      0.01
04:30:01 PM    enp0s3     13.15     13.01      2.12      2.31      0.00      0.00      0.01
04:40:01 PM    enp0s3     14.94     13.16      2.35      2.26      0.00      0.00      0.01
04:50:01 PM    enp0s3     11.45     11.38      2.02      1.99      0.00      0.00      0.01
05:00:01 PM    enp0s3     12.45     12.30      2.22      2.04      0.00      0.00      0.01
05:10:01 PM    enp0s3     13.59     12.33      2.27      2.04      0.00      0.00      0.01
Average:       enp0s3     14.30     13.45      2.32      2.42      0.00      0.00      0.01
```

* `IFACE`: 网络设备名.
* `rxpck/s`: 每秒接收的包总数.
* `txpck/s`: 每秒传输的包总数.
* `rxbyt/s`: 每秒接收的字节(byte)总数.
* `txbyt/s`: 每秒传输的字节(byte)总数.
* `rxcmp/s`: 每秒接收压缩包的总数.
* `txcmp/s`: 每秒传输压缩包的总数.
* `rxmcst/s`: 每秒接收的多播(multicast)包的总数.

### 输出网络设备状态的统计信息(查看网络设备故障) `sar -n EDEV |egrep xxx`

```
sar -n EDEV | egrep 'enp0s3|IFACE'
01:50:01 PM     IFACE   rxerr/s   txerr/s    coll/s  rxdrop/s  txdrop/s  txcarr/s  rxfram/s  rxfifo/s  txfifo/s
02:00:01 PM    enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
02:10:01 PM    enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
02:20:01 PM    enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
02:30:01 PM    enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
02:40:01 PM    enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
02:50:01 PM    enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
03:00:01 PM    enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
03:10:01 PM    enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
03:20:02 PM    enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
03:30:01 PM    enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
03:40:01 PM    enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
03:50:01 PM    enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
04:00:01 PM    enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
04:10:01 PM    enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
04:20:01 PM    enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
04:30:01 PM    enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
04:40:01 PM    enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
04:50:01 PM    enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
05:00:01 PM    enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
05:10:01 PM    enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
05:20:01 PM    enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
Average:       enp0s3      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00      0.00
```

* `IFACE`: 网络设备名.
* `rxerr/s`: 每秒接收的坏包总数.
* `txerr/s`: 传输包时每秒发生错误的总数.
* `coll/s`: 传输包时每秒发生冲突（collision）的总数.
* `rxdrop/s`: 接收包时, 由于缺乏缓存, 每秒丢弃(drop)包的数量.
* `txdrop/s`: 传输包时, 由于缺乏缓存, 每秒丢弃(drop)包的数量.
* `txcarr/s`: 传输包时, 每秒发生的传输错误(carrier-error)的数量.
* `rxfram/s`: 接收包时, 每秒发生帧校验错误(frame alignment error)的数量.
* `rxfifo/s`: 接收包时，每秒发生队列（FIFO）一出错误的数量.
* `txfifo/s`: 传输包时，每秒发生队列（FIFO）一出错误的数量.

### 输出进程队列长度和平均负载状态统计信息`sar -q`

```
sar -q
Linux 3.10.0-514.el7.x86_64 (mysql-1) 	03/08/2018 	_x86_64_	(2 CPU)

01:50:01 PM   runq-sz  plist-sz   ldavg-1   ldavg-5  ldavg-15   blocked
02:00:01 PM         0       236      0.00      0.01      0.05         0
02:10:01 PM         0       236      0.00      0.01      0.05         0
02:20:01 PM         0       237      0.00      0.01      0.05         0
02:30:01 PM         1       236      0.00      0.01      0.05         0
02:40:01 PM         0       236      0.02      0.02      0.05         0
02:50:01 PM         0       236      0.00      0.01      0.05         0
03:00:01 PM         0       236      0.00      0.01      0.05         0
03:10:01 PM         0       236      0.00      0.01      0.05         0
03:20:02 PM         0       236      0.00      0.01      0.05         0
03:30:01 PM         0       236      0.00      0.01      0.05         0
03:40:01 PM         0       236      0.00      0.01      0.05         0
03:50:01 PM         0       236      0.00      0.03      0.05         0
04:00:01 PM         0       236      0.00      0.01      0.05         0
04:10:01 PM         0       236      0.00      0.01      0.05         0
04:20:01 PM         0       236      0.00      0.01      0.05         0
04:30:01 PM         0       236      0.00      0.03      0.05         0
04:40:01 PM         0       236      0.00      0.01      0.05         0
04:50:01 PM         0       236      0.01      0.02      0.05         0
05:00:01 PM         1       236      0.00      0.02      0.05         0
05:10:01 PM         0       236      0.19      0.09      0.06         0
05:20:01 PM         0       236      0.08      0.04      0.05         0
Average:            0       236      0.01      0.02      0.05         0
```

* `runq-sz`: 运行队列的长度(等待运行的进程数).
* `plist-sz`: 进程列表中进程(processes)和线程(threads)的数量.
* `ldavg-1`: 最后1分钟的系统平均负载(System load average).
* `ldavg-5`: 过去5分钟的系统平均负载.
* `ldavg-15`: 过去15分钟的系统平均负载.
* `blocked`: 当前阻塞的进程数量, 在等待IO完成.

### 输出系统交换活动信息 `sar -w`

```
sar -w
Linux 3.10.0-514.el7.x86_64 (mysql-1) 	03/08/2018 	_x86_64_	(2 CPU)

01:50:01 PM    proc/s   cswch/s
02:00:01 PM      0.13    160.81
02:10:01 PM      0.13    165.05
02:20:01 PM      0.11    167.96
02:30:01 PM      0.03    157.05
02:40:01 PM      0.06    161.81
02:50:01 PM      0.03    124.72
03:00:01 PM      0.12    127.55
03:10:01 PM      0.68    163.34
03:20:02 PM      0.21    137.13
03:30:01 PM      0.46    177.43
03:40:01 PM      0.03    159.99
03:50:01 PM      0.08    159.17
04:00:01 PM      0.02    162.72
04:10:01 PM      0.09    136.07
04:20:01 PM      0.01    151.43
04:30:01 PM      0.02    156.84
04:40:01 PM      0.01    159.62
04:50:01 PM      0.01    155.01
05:00:01 PM      0.01    160.18
05:10:01 PM      0.04    159.08
05:20:01 PM      0.04    159.60
05:30:01 PM      0.02    154.69
05:40:01 PM      0.01    154.30
Average:         0.10    155.28
```

* `proc/s`: 每秒钟创建的进程数.
* `cswch/s`: 每秒钟的上下文交换数.

### 输出系统交换的统计信息 `saw -W`

```
sar -W
Linux 3.10.0-514.el7.x86_64 (mysql-1) 	03/08/2018 	_x86_64_	(2 CPU)

01:50:01 PM  pswpin/s pswpout/s
02:00:01 PM      0.00      0.00
02:10:01 PM      0.00      0.00
02:20:01 PM      0.00      0.00
02:30:01 PM      0.00      0.00
02:40:01 PM      0.00      0.00
02:50:01 PM      0.00      0.00
03:00:01 PM      0.00      0.00
03:10:01 PM      0.00      0.00
03:20:02 PM      0.00      0.00
03:30:01 PM      0.00      0.00
03:40:01 PM      0.00      0.00
03:50:01 PM      0.00      0.00
04:00:01 PM      0.00      0.00
04:10:01 PM      0.00      0.00
04:20:01 PM      0.00      0.00
04:30:01 PM      0.00      0.00
04:40:01 PM      0.00      0.00
04:50:01 PM      0.00      0.00
05:00:01 PM      0.00      0.00
05:10:01 PM      0.00      0.00
05:20:01 PM      0.00      0.00
05:30:01 PM      0.00      0.00
05:40:01 PM      0.00      0.00
Average:         0.00      0.00
```

* `pswpin/s`: 每秒钟系统**引入**的`swap pages`.
* `pswpout/s`: 每秒钟系统**换出**的`swap pages`.

### 输出TTY设备的活动信息 `sar -y`

我的命令报错.

```
sar -y

```

* `TTY`: `TTY`串行设备号.
* `rcvin/s`: 每秒接收的中断数量.
* `xmtin/s`: 每秒传送的中断数量.
* `framerr/s`: 每秒发生的帧错误数(frame error)量.
* `prtyerr/s`: 每秒发生的奇偶校验错误(parity error)数量.
* `brk/s`: 每秒发生的暂停(break)数量.
* `ovrun/s`: 每秒发生的溢出错误(overrun error)数量.

## 知识点

`sar`收集统计信息.

```
sudo cat /etc/cron.d/sysstat
# Run system activity accounting tool every 10 minutes
*/10 * * * * root /usr/lib64/sa/sa1 1 1
# 0 * * * * root /usr/lib64/sa/sa1 600 6 &
# Generate a daily summary of process accounting at 23:53
53 23 * * * root /usr/lib64/sa/sa2 -A
```
