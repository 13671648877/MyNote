#C语言中const,volatile,restrict的用法总结

###const

变量声明中带有关键词const,**`意味着不能通过赋值,增量或减量来修改该变量的值`**,

####指针和const

**指针使用const**

* 指针本身为`const`
* 指针指向的值为`const`

**指向const的指针**

`指针`**`指向`**`的内容是不能被修改的`.两种写法:

* `const int* p`(推荐)
* `int const* p`(不要使用,容易混淆)

`const int* p`: p是一个指针,它指向的内容是const int 类型.p本身不用初始化它可以指向任何标示符,但它指向的内容是不能被改变的.

`int const* p`: 也是表示的是指向const的指针

**const指针**

`指针`**`本身`**`的值是不能被修改的`.

	int* const p=一个地址
	
	因为指针本身的值是不能被修改的所以它必须被初始化
	
p是一个指针,这个指针是指向int的const指针.它`指向的值是可以被改变`的如*p=3;

**指针本身和它指向的内容都是不能被改变**

	const int* const p = 一个地址;

    int const* const p = 一个地址;
    
**理解规律**

一个位于`*左边`任意位置的const使得`数据成为常量`,而一个位于`*右边`的const使得`指针本身成为const`.

* `指向const的指针`(指针指向的内容不能被修改),const关健字总是出现在*的`左边`.

* `const指针`(指针本身不能被修改),const关健字总是出现在*的`右边`.

* `两个const中间加个*`肯定是指针本身和它指向的内容都是不能被改变的.

**示例**


		int main(int argc, char *argv[]){
		    int a=3;
		    int b;
		    
		    /*定义指向const的指针（指针指向的内容不能被修改）*/ 
		    const int* p1; 
		    int const* p2; 
		    
		    /*定义const指针(由于指针本身的值不能改变所以必须得初始化）*/ 
		    int* const p3=&a; 
		    
		    /*指针本身和它指向的内容都是不能被改变的所以也得初始化*/
		    const int* const p4=&a;
		    int const* const p5=&b; 
		    
		     p1=p2=&a; //正确
		     *p1=*p2=8; //不正确（指针指向的内容不能被修改）
		    
		     *p3=5; //正确
		     p3=p1; //不正确（指针本身的值不能改变） 
		    
		     p4=p5;//不正确 （指针本身和它指向的内容都是不能被改变） 
		     *p4=*p5=4; //不正确（指针本身和它指向的内容都是不能被改变） 
		     
		    return 0; 
		}

###volatile

对象的类型如果有volatile限定符,就可能会被其他执行程序或事件所修改.`volatile`关键字告诉编译器在每次使用此对象的值时,都要重新读取,即使程序本身并没有修改它的值.

###restrict

用于告诉编译器,对象已经被指针所引用,**`不能`**`通过除该指针外所有其他直接或间接的方式修改该对象的内容`.

**示例**
		
		int ar[10];
		int * restrict restar=(int *)malloc(10*sizeof(int));
		int *par=ar;
		
* restar是访问由malloc()分配的内存的`唯一`且初始的方式.
* par不是

运行代码:


		for(n=0;n<10;n++){
		par[n]+=5;
		restar[n]+=5;
		ar[n]*=2;
		par[n]+=3;
		restar[n]+=3;
		}

因为restar是访问分配的内存的`唯一且初始的方式`那么编译器可以将上述对restar的操作进行优化:

		restar[n]+=8;
		
而par并`不是`访问数组ar的唯一方式,因此并`不能`进行下面的优化:

		par[n]+=8;
		
因为在par[n]+=3前,ar[n]*=2进行了改变.

**使用**

关键字restrict有两个读者.

1. 一个是编译器,它告诉编译器可以自由地做一些有关优化的假定.
2. 另一个读者是用户,他告诉用户仅使用满足restrict要求的参数.

**需要程序员自己维护**

一般,编译器**`无法`**检查您是否遵循了这一限制,如果您蔑视它也就是在让自己冒险.