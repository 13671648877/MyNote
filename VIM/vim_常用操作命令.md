#VIM 常用操作命令

---

#### 基本命令

#### 移动

**`w`**

移致下一个单词的词首.

**`e`**

跳至当前或下一个单词的词尾.

**`b`**

跳至当前或前一个单词的词首.

`b`和`w`是相对的.

**`#w`**

移动`#`个单词.

**`Ctrl+o`**

调回到旧的位置.

CTRL-O goes to the older position, and CTRL-I or tab goes to the newer one. 仅限于normal mode

**`Ctrl+I(i)`**

调到新的位置.

CTRL-O goes to the older position, and CTRL-I or tab goes to the newer one. 仅限于normal mode

##### 插入类

**`i`**

在光标签插入.

**`I`**

到行首插入.

**`a`**

在光标后插入.

**`A`**

在行尾插入.

**`s`**

删除字符并插入.

**`S`**

删除行并插入.

**`<Ctrl+v>{123}`**

以十进制字符编码插入字符.

**`<Ctrl+v>u{123}`**

以十六进制字符编码插入字符

**`<Ctrl+v>u{非数字}`**

按原义插入非数字字符。

**`<Ctrl+k>{char1}{char2}`**

插入以二合字母{char1}{char2}表示的字符

**`ga`**

光标移到任意字符上,按`ga`可以查看十进制和十六进制的编码.

##### 修改类

**`r`**
替换光标处的字符.

**`R`**
进入替换模式,按esc回到正常模式.

**`cj`**

修改下一个字符. 等同于`s`.

**`C or c$`**

修改当前行上光标后面的部分.进入编辑状态

**`c0 or c^`**

表示从光标处到当前行行首的部分进行修改,^代表首个非空格处.

**`cc or S`**

修改当前行.进入编辑状态.

**`cw`**

从光标所在的位置开始到该`单词结束`进行修改.进入编辑状态.

**`cfx AND cFx`**

这里的 x 为一任意字符.

* cfx 表示修改从光标到`下`一个字符 x 之间的文本.
* cFx 表示修改从光标到`上`一个字符 x 之间的文本.

**`cn|`**

修改从光标到当前行的第 n 个字符间的所有字符, n 正整数.

**`cnG and cG`**

这里的 n 为一任意自然数.

* cnG 表示修改当前行到第 n 行之间的所有行.
* cG 表示修改当前行直至末行.

##### 查询

`f`和`t`的区别只是光标停留的地方不一样.

**`fx`**

在行内搜索`x`字母.且光标停在x上.

**`Fx`**

在行内反向搜索`x`字母.且光标停在x上.

**`tx`**

在当前行内搜索`x`,光标停在前一个`x`的前一个字符上面.且光标停在x前.

**`Tx`**

在当前行内反向搜索`x`,光标停在前一个`x`的前一个字符上面.且光标停在x后.

**`;`**

在相同方向重复上一个搜索命令.

**`,`**

在相反方向重复上一个搜索命令.

**`*`**

搜索当前光标所在的词，相当于对当前词进行`/搜索`,比如,光标停在词google内的任何字符上,那么`*命令就相当于/google`.

##### 换行类

**`o`**

在当前光标下行分段.

**`O`**

在当前光标上行分段.

##### 删除类

**`x`**

剪切光标当前字符.

**`dd`**

剪切当前行.

**`daw`**

剪切一个单词. 即使光标不在词首和句首也没关系.

还会删除一个空格, 停留在下一个词的词首,如果没有下一个词则停留在上一个词的词尾.

用`.`命令可以方便的重复执行.

**`das`**

剪切一个句子. 即使光标不在词首和句首也没关系.

**`dap`**

剪切一个段落.

**`Ctrl+h`**

删除前一个字符,同空格键. ==在bash下同样生效==

**`Ctrl+w`**

删除前一个单词, ==在bash下同样生效==

**`Ctrl+u`**

删除至行首, ==在bash下同样生效==

##### 缩进类

**`>G`**

增加从当前航到文档末尾处的层级缩进.

按照`>`同时安装`G`,可以进行缩进.

可以在执行一次以后按`.`重复执行.

**`<G`**

反方向缩进.

可以在执行一次以后按`.`重复执行.

**`n==`**

表示自动缩进从当前行起的下面n行. `n`是自然数.

直接按`==`表示对当前行缩进.u

##### 重复 和 回退

**`.`**

重复上次命令.

从进入插入模式的那一刻起(例如,输入`i`),直到返回普通模式时为止(输入`<ESC>`),Vim会记录每一个按键操作.作出这样的修改后再用`.`可以重复执行.

**`u`**

撤销命令.

在进入插入模式开始,知道返回普通模式为止,在此期间输入或删除的任何内容都被当做一次修改.

最好让每个==可撤销块==对应一次==思考过程==.

**修改**

* 重复 `.`
* 回退 `u`

**在行内查找`下`一个指定字符**

`f{char}/t{char}`

* 重复 `;`
* 回退 `,`

**在行内查找`上`一个指定字符**

`F{char}/T{char}`

* 重复 `;`
* 回退 `,`

**在文档中查找`下`一处匹配项**

`/pattern<回车>`

* 重复 `n`
* 回退 `N`

**在文档中查找`上`一处匹配项**

`?pattern<回车>`

* 重复 `n`
* 回退 `N`

**执行替换**

`:s/target/replacement<回车>`

* 重复 `&`
* 回退 `u`

**执行一系列修改**

`qx{changes}q`

* 重复 `@x`
* 回退 `u`

#### 加法和减法

数字`007`,vim会把其当做`8`进制数字.如果执行`1Ctrl+a`则会变成`010`.即8进制的`8`.如果不想使用`8`进制.需要把下面的行加入`vimrc`:

		set nrformats=

**`#(数字)Ctrl+A`**

会对数字执行 ==加n== 操作.

如果当前光标不在数字,则在当前行正向查找一个数字,如果找到了则执行,

**`#(数字)Ctrl+x`**

会对数字执行 ==减n== 操作.

如果当前光标不在数字,则在当前行正向查找一个数字,如果找到了则执行,

#### 视角切换

**`zz`**

把当前航显示在窗口正中.

可以配合`Ctrl+o`一起使用.在插入模式`Ctrl+o zz`可以迅速定位到屏幕中央,并且又立即(在普通模式下执行完`zz`命令)返回到插入模式.

#### 普通,命令模式切换

**`Esc`**

切换到普通模式

**`Ctrl+[`**

切换到普通模式

**`Ctrl+o`**

在插入模式执行.在命令模式执行是跳转的意思.

执行==一个==普通模式命令,执行完后,马上就又返回到插入模式.

#### 替换模式

在普通替换模式`R`中,如果键入一个字符,会把一个占据8列的制表符用占据一个字符的普通字符替换(列宽度变小了)(即按文本中保存时占据的列数替换字符).

在虚拟替换模式`g`R中,需要键入8个字符才能替换该制表符(即按屏幕实际显示的宽度替换字符)

单次版本的替换模式及虚拟替换模式`r{char}` 和 `gr{char}`,允许我们覆盖一个字符,之后马上又回到普通模式.

#### 宏

**`qx` `q` `@x`**

首先按`qx`,会提示开始记录宏. 录制完成后按`q`,退出记录模式.

`@x`播放记录在x寄存器中的宏命令

		(按qx) ddsssadasd (esc, 按q)
		(按@x,播放上次的记录) ddsssadasd (按@x,播放上次的记录) ddsssadasd

#### 转换大小写

命令需要组合使用,不能单独使用

		guw,gue 转换一个单词.
		
		gu5w 转换5个单词.
		
		gu0 从光标所在位置到行首,都变为大写
		gu$ 从光标所在位置到行尾,都变为小写

**`g~`**

反转大小写.

**`gu`**

转换为小写.

**`gU`**

转换为大写.

#### 刷新加载文件

**`e!`**

手动重新加载文件

#### 命令行

就是按`Esc`.

**`:print`**

在命令行下方回显指定行的内容.

缩写是 `:p`.

**`:#(数字)`**

跳到`#`行.

**`:#(start),#(end)`**

指定范围. 第一个`#`表示的是起始行.第二个`#`表示的是结束行.

**`:.`**

`.`表示当前行的地址.

**`:$`**

表示文件最末尾行.

**`:%`**

表示文件所有行. 等效于 `:1,$`.

**`:'<,'>`**

代表高亮选区的范围.

* `'<`: 表示高亮选区首行的位置标记.
* `>'`: 表示高亮选区的最后一行.

**模式指定范围**

`:/<html>/,/<\/html>/p`

* {start} 地址是模式 `/<html>/`
* {end} 地址是模式 `/<\/html>/`

这里地址选择是对应`<html>`开标签所在的行开始,到对应标签所在的行结束.

**偏移地址**

`:{address}+n`.

如果`n`被省略,那么缺省偏移量为`1`.`{address}`可以是一个行号,一个位置标记,或是一个查找模式.
	
		:2
		:.,.+3p
		
		符号 . 代表当前航,所以上例相当于 :2,5
		
**`:copy`**

可以把文档的一行或多行从文档的一部分复制到另一部分.

`:[range]copy {address}`

可以简写为:

* `:co`
* `:t`

		:6t. 把第6行复制到当前行下方
		:t6	 把当前行复制到第6行下方
		:t.  为当前行创建一个副本(复制黏贴当前行)
		:t$	 把当前行复制到文本结尾
		:'<,'>t0 把高亮选中的行复制到文件开头
		
`:t.` 效果等同于 `yyp`. 但是 `yyp` 会使用寄存器.

**`:move`**

可以把文档的一行或多行移到文档的其他地方.

#### 全局命令 `g`

* `:[range]g/pattern/cmd`
* `:g/pattern1/,/pattern2/cmd`

        :g/test/d
        删除所有带test的行
        :g!/test/d
        保留带test的行
        :g/hello/,/world/d
        删除所有hello,world之间的行

#### 可视模式,选择模式

**`v`**

激活面向字符的可视模式.

**`V`**

激活面向行的可视模式.

**`Ctrl+v`**

激活面向块的可视模式.

**`Ctrl+g`**

在可视模式中可以切换为选择模式.

* `--VISUAL--` 可视模式
* `--SELECR--` 选择模式

#### 标记 (mark)

利用标记可以快速移动.

**添加标记**

光标移到某一个行,使用`m{a-z,A-Z}`命令添加标记.

* `a-z` 引用于当前缓冲区.
* `A-Z` 跨越不同的缓冲区.比如正在编辑`File1`,但仍然可以使用`'A`命令,移动到`File2`中创建的标记`A`.

**跳转标记**

* =='{ch}== 跳到指定标记行的首个非空字符.
* ==`{ch}== 移到所做标记时的光标位置.

**列出标记**

`:marks`,可以列出所有标记.也包括一些系统内置的特殊标记:

* . ——最近编辑的位置
* 0-9 ——最近使用的文件
* ∧ ——最近插入的位置
* ' ——上一次跳转前的位置
* " ——上一次退出文件时的位置
* [ ——上一次修改的开始处
* ] ——上一次修改的结尾处

**删除标记**

`:delmarks a b c`, 可以删除某个或多个标记

`:delmarks!`,会删除所有标记. 只删除当前的,不删除`A-Z,0-9`.

#### 示例

**在行尾添加`;`**

1. `A`到行尾处添加
2. `;`添加分号
3. `<ESC>`回到命令模式

如果要修改其他行可以移动到其他行,然后按`.`重复添加`;`的命令.

**指定多行删除**

VI中的多行删除与复制
法一：
单行删除，：1（待删除行）d
多行删除 ，：1,10d

**批量添加注释**

在10 - 20行添加 // 注释

		:10,20s#^#//#g
		
在10 - 20行删除 // 注释

		:10,20s#^//##g
		
在10 - 20行添加 # 注释

		:10,20s/^/#/g
		
在10 - 20行删除 # 注释

		:10,20s/^/#/g
		

**多行复制**

复制`9-15`行, 黏贴到`16`行.

		:9，15 copy 16  或 :9，15 co 16
		
**多行剪切**

剪切`9-15`行, 黏贴到`16`行.

		:9，15 move 16  或 :9，15 m 16
		
**批量查找**

		:vimgrep /搜索内容/*
		
* `:cnext(:cn)`         下一个匹配位置
* `:cprevious(:cp)`     上一个匹配位置
* `:cwindow(:cw)`     	 quickfix窗口，可以选择匹配的文件位置
* `:cl(:clist)`         查看所有匹配的位置

**快捷操作文件**

		:new 文件名.后缀 新建文件
		
		:e 文件名 打开文件
		
		:w 文件名 保存文件
		
		:wq	保存呢并推出
		
		:x 退出, 如果文件更改则保存
		
**自动折行**

		:set wrap 设置自动折行
		:set nowrap 设置不自动折行