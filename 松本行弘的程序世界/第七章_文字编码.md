# 第七章 文字编码

### 文字编码的种类

从 CPU 的层次来看,计算机所处理的各种数据都是用比特 ON/OFF 所表现的二进制数字.

#### 早的文字编码

为了让本来只能表示二进制数的计算机能够处理文字,就必须将文字变换为相应的数字.这种对应文字的数值就称为文字编码.

**ASCII**

ASCII 码由 7 位二进制数构成,可以变现英文字母,数字和一些几号($,&等),共128个字符.这带来的一个好处就是,对于通信单位的字节(8位)来说,可以省出1位,用于附加错误检测码.

#### 纸带与文字表现

纸带上每排有8个孔,用于表示一个字节.每排的图案代表一个字符.

纸带还可以通过纸带读入器再度读入计算机,所以纸带也作为存储器使用.

**补丁**

当时的程序大多是通过读纸带来执行的.一旦纸带上的程序有了bug,只能用肩带将纸带咔擦咔擦剪掉,然后再接上修正的方法,诚如恰如字面意义上的补丁.

**DEL**

`DEL`也分配了一个编码 127 (十六进制的 0x7F). 0x7F 的 7位全部都是 ON, 用 DEL 覆盖既有字符时,既有字符就全部消失了.

这也就是`DEL`的含义.

#### 文字是什么

* 文字: 用==视觉方式==表现语言体系所用的符号
* glyph: 个别文字的字形
* 文字集: 分配了文字编码的文字的集合
* 文字编码: 分配给每一个文字的编码
* 文字编码方式: 在计算机上表现文字编码的方式

计算机上仅仅用整数值来表示文字编码的方式称为文字编码方式.

#### Unicode 的两个问题

**字节顺序**

* little endian : 低位的8位先放.
* big endian : 高位的8位先放.

类似有 UTF-16BE 和 UTF-16LE.

#### Unicode 的文字集

现在, Unicode 放弃 16 位方式, 而用 21 位来表示一个文字.

#### Unicode 的字符编码方式

**UTF-8**

UTF-8 为可变长的, 与 ASCII 具有兼容性的编码方式.

### 程序中的文字处理

#### Unicode 有多重字符编码方式

**UTF-16**

Unicode 中能以 16 位表示的空间 (Basic Multilingual Plane, BMP) 就以 16 位为单位来表示, 超过 16 位空间的就以称为代理对的两个 16 位码 (32位) 的组合来表示.

==但现在 Unicode 已经超越 16位, UTF-16 也不再有什么优点==, 没有必要再采用这种字符编码方式了.

**UTF-32**

UTF-32 以 32 位证书来表示 Unicode.

缺点: 在 ASCII 中只要 8 位 就能表示的英文字母或数字, 在 UTF-32 中却要占用 32 位, 因为存在内存使用率低,以及字节顺序等问题.

不适合: 用于通信以及文件保存等文本数据的外部表示,更适合用于字符串处理的内部表示.

**UTF-8**

* 比 UTF-16 和 UTF-32 内存使用稍微高些
* 没有字节顺序问题
* 是可变长的,所以文字的随机访问性能低

#### 字符编码方式错误

文本数据都不附加文字编码方式的信息,所以容易引起错误.

很多应用软件在读入文本数据以后,大体会按一下方法来尝试自动检出:

* 检查只在某种字符编码方式下才会出现的字节排列,从而来确定编码方式.
* 如果不能确定,则按照文字的出现频率来推测.

HTTP 传送的文本数据中可以指定字符编码方式: `content-type1.

#### 编程语言的角度处理文字

**UCS**

UCS (Universal Character Set, 泛用字符集),是指程序中所处理的共同文字集(及字符编码方式).输入输出时,编程语言将文本数据变成 UCS, 内部对文本数据进行统一处理.

		输入是 EUC-JP,输出也是 EUC-JP
		
		UCS 中: EUC-JP -> UTF-16 -> EUC-JP 变换
		
**CSSI**

CSI (Character Set Independent, 字符集独立), 是指不对各种文字集(及编码方式)进行任何变换,原封不动进行处理.
