#03_04 Linux用户及权限详解

###笔记

---

**用户,用户组**

用户组是一个`容器`,用户放到该容器内,自动就有了该用户组的`权限`.

用户组是一个逻辑概念,本身并不能直接使用.用于`方便的指派权限`.

用户就是获取资源服务的`凭证`.映射到系统中,用户是`唯一的标识符`.组也是`标识符`.

定义`文件`为哪一个`标识符`所有..用户访问哪个资源,被机器映射为`标识符`.

**进程也是有属主和属组的**

**安全上下文(secure context)**

任何时候用户操作计算机,发起进程.进程是用户操作计算机的`代理`,所以进程在运行的时候是以`发起它用户的身份`在进行.所以进程能访问哪些文件,取决于`进程自己的权限`和`它访问的文件权限`.这个过程的判断,是由系统资源的`安全管理属性自动完成`(内核的管理下完成的).

**3类权限**

* 属主的权限
* 属组的权限
* 其他用户的权限

**权限**

`r,w,x`

`文件`:

* `r` 可读,可以使用文件`查看`命令(cat等命令)查看内容
* `w` 可写,可以`编辑`或`删除`此文件
* `x` 可执行,可以在命令提示符下当做`命令`提交给`内核运行`(发起进程)

`目录`:

* `r` 可以对此没有路执行`ls`以列出内部的所有文件
* `w` 可以在此目录`创建`文件.`删除文件`取决于`文件自身的权限`
* `x` 可以使用`cd`切换进此目录,也可以使用 `ls -l` 查看内部文件的详细信息

`默认`建议`文件不要有执行`权限,但是`目录需要有执行权限`.

**rwx**

		r-- 只读
		r-x 读和执行
		--- 无权限
		 
`0` `000`, `---`: 无权限  
`1` `001`, `--x`: 执行  
`2` `010`, `-w-`: 写
`3` `011`, `-wx`: 写和执行
`4` `100`, `r--`: 只读
`5` `101`, `r-x`: 读和执行
`6`	`110`, `rw-`: 读写
`7` `111`, `rwx`: 读写执行 

		755 rwxr-xr-x(属主,属组,其他) 用8进制表示权限
		
**计算机识别用户和进程依靠数字**

`用户`: UID,/etc/passwd 数据库,用户的对应关系
`用户组`: GID, /etc/group

`解析`:名称解析. 用户 -> UID

`影子口令`:

* 用户: /etc/shadow (用户密码存放)
* 用户组: /etc/gshadow (用户组密码存放)

`用户类别`:

* 管理员: uid(0)
* 普通用户: uid(1-65535) (16位2进制)
	* 系统用户: uid(1-499)
	* 一般用户: uid(500-60000)
 
`系统用户`:

专门运行后台进程的用户. 这类用户是`不需要登陆`的,限定登录系统.

`用户组类别`:

* 管理员组
* 普通组
	* 系统组
	* 一般组
	
`用户组分类`:

* `基本组`:每个用户都有一个默认组.
* `私有组`:创建用户时,如果没有为其指定所属的组,系统会自动为其创建`一个与用户名同名的组`.
* `附加组`,`额外组`:默认组以外的其它组

**进程**

进程也有`属主`,`属组`.系统任何进程都是可执行文件,运行起来是`进程`.运行之前都是以某个用户的身份去运行的.进程可以执行哪些文件,取决于`发起进程的身份`.

**系统的合法shell**

`/etc/shells`

		$ cat /etc/shells
		/bin/sh
		/bin/bash
		/sbin/nologin
		/bin/tcsh
		/bin/csh

**/etc/shadow**

`account`: 登录名
`encrypted password`: 加密的密码
		
		$1$xxxx$xxx
		
		$加密方式$salt$加密后的密码

**加密方法**

* `对称加密`: 加密和解密使用同一个`密码`.
* `公钥加密`: 每个密码都成对出现,一个叫`私钥`(secret key),一个为`公钥`.`公钥加密只能用与之配对的私钥解密`.
* `单向加密`,`散列加密`: 可以明文取得密文,反之不行.用于提取数据`特征码`,用于
	
	* `雪崩效应`: 数据小小的改变,但是结果会产生很大变化.
	* `定长输出`: 
			
		* `MD5`: Message Digest(信息摘由), 128位定长输出
		* `SHA1`: Secure Hash Algorithm, 160位定长输出

**USERADD**

		USERADD username 添加用户
		
添加用户的默认属性来自`/etc/default/useradd`下

		# cat /etc/default/useradd
		
		# useradd defaults file
		GROUP=100
		HOME=/home
		INACTIVE=-1
		EXPIRE=
		SHELL=/bin/bash
		SKEL=/etc/skel
		CREATE_MAIL_SPOOL=yes
		
`HOME = /home` 如果没有给用户指定家目录,在这个目录下给用户建立一个同名的家目录  
`INACTIVE=-1` 密码过期还没改宽限几天的天数  
`EXPIRE=` 没指定代表不用过期  
`SHELL=/bin/bash` 默认shell

**组文件格式**

`/etc/group` `组名`:`密码`:`组id`:`额外组`

**添加组**

`groupadd`

**用户及权限常用命令**

* 用户管理: `useradd`,`userdel`,`usermod`,`passwd`,`chsh`,`finger`,`id`,`chae`
* 组管理: `groupadd`,`groupdel`,`groupmod`,`gpasswd`
* 权限管理: `chown`,`chgrp`,`chmod`,`umask`

###整理知识点

---