# 38_02_Linux集群系列之八——高可用集群原理详解之共享存储

---

## 笔记

---

### 硬盘接口

* IDE(ATA): 130MB/s
* SATA: 150MB/s, SATA3达到 600MB/s
* SCSI: 320MB/s, Small Computer System Interface.
* SAS: 600MB/s
* USB:

转数(决定iops):

* IDE, SATA: 7200rpm (7200转每分钟), IOPS: 100
* SCSI,SAS: 15000rpm (15000转每分钟), IOPS: 200
* USB:
	* 2.0: 480Mbps = 60MB/s (1B = 8b)
	* 3.0: 3.2Gbps = 400MB/s 

	
* 机械: 机器臂移动 + 等待扇区转过来 
	* 随机读写
	* 顺序读写, 性能好, 不需要重新寻道和移动机械臂
* 固态(电子设备):
	* 不存在随机读写和顺序读写的概念

* 并口
	* IDE, SCSI
* 串口
	* SATA,SAS,USB

* 北桥: 高速率总线
* 南桥: 慢速率总线

#### 存储设备

* DAS: 直接附加存储, Direct Attached Storage. 直接接到本机主板总线(BUS), 当前主机会直接识别为一个存储设备. 很难实现共享.
* NAS: 网络附加存储, Network Attached Storage. 文件服务器: 文件级别.
* SAN: 存储区域网络, Storage Area Network. 将本地总线上的数据转换成能够通过网络发送, 延长了`DAS`设备传输距离的共享设备. 支持多节点同时接入(可以共享给多个节点同时使用).
	* FC(光纤) SAN
	* IP SAN

## 整理知识点

每一个主板都有一个插槽. cpu 通过总线连到北桥. 北桥和南桥都会连接到各种接口.

### NAS 原理

本机通过**NAS**文件服务器存储数据实现原理:

将内存中的数据转换成网卡IO(网络请求), 通过网络请求连接到其他主机上, 通过其他主机写到硬盘上.

每一个文件都对应一个磁盘块. 在文件系统抽象视角是文件, 在磁盘(总线)视角是块级别请求, 通过网络IO发送的是文件. 

**NAS不是通过块,驱动以及设备来访问文件的, 是通过文件系统的IO来访问文件的**.

### 如何将磁盘数据载入内存

`CPU`发出寻址指令, 查找内存中有无文件, 如果没有文件, 进程控制CPU到硬盘加载文件. CPU需要转换到内核模式, 通过磁盘驱动程序, 寻道, 一次读一个**块**依次读到内存的**页**.

**SCSI**中有一个芯片, 第一次CPU通过磁盘读取到内存, 后续都通过这个芯片来读取. 读取完成后通知CPU.

---